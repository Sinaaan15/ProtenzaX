<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>My Account - ProtenzaX</title>
  <link rel="stylesheet" href="styles.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body>

<!-- MENU BUTTON -->
<button id="menuBtn" class="menu-btn" onclick="toggleMenu()">☰</button>

<!-- ACCOUNT ICON -->
<div class="account-container">
  <i class="fas fa-user-circle account-icon"></i>
</div>

<!-- SIDEBAR -->
<div id="mySidebar" class="sidebar">
  <span class="close-btn" onclick="toggleMenu()">✖</span>
  <a href="index.html">Home</a>
  <a href="menu.html">Our Menu</a>
  <a href="account.html">My Account</a>
</div>

<!-- OVERLAY -->
<div id="overlay" class="overlay" onclick="toggleMenu()"></div>

<header>
  <h1>ProtenzaX</h1>
  <p><b><i>Built by Dedication. Fueled by Protein.</i></b></p>
</header>

<section>
  <h2>My Account</h2>

  <div class="account-box">

    <p><strong>Name:</strong> <span id="userName">Loading...</span></p>
    <p><strong>Phone:</strong> <span id="userPhone">Loading...</span></p>
    <p><strong>Email:</strong> <span id="userEmail">Loading...</span></p>
    <p><strong>Gender:</strong> <span id="userGender">Loading...</span></p>
    <p><strong>Age:</strong> <span id="userAge">Loading...</span></p>

    <button class="edit-btn" onclick="window.location.href='profile-setup.html'">
      Edit Profile
    </button>

    <button class="logout-btn" onclick="logoutUser()">
      Logout
    </button>

  </div>

</section>

<footer>
  <p>© 2025 ProtenzaX | All Rights Reserved</p>
</footer>

<!-- FIREBASE FETCH LOGIC -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
  import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";
  import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "",
    authDomain: "",
    projectId: "",
    storageBucket: "",
    messagingSenderId: "",
    appId: ""
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth();
  const db = getFirestore();

  onAuthStateChanged(auth, async (user) => {
    if (!user) {
      window.location.href = "login.html";
      return;
    }

    document.getElementById("userPhone").innerText = user.phoneNumber;

    const ref = doc(db, "users", user.uid);
    const snap = await getDoc(ref);

    if (snap.exists()) {
      const data = snap.data();
      document.getElementById("userName").innerText = data.name || "Not set";
      document.getElementById("userEmail").innerText = data.email || "Not set";
      document.getElementById("userGender").innerText = data.gender || "Not set";
      document.getElementById("userAge").innerText = data.age || "Not set";
    } else {
      window.location.href = "profile-setup.html";
    }
  });

  window.logoutUser = function () {
    signOut(auth).then(() => {
      window.location.href = "index.html";
    });
  }
</script>

<!-- TOGGLE MENU SCRIPT -->
<script src="script.js"></script>

</body>
</html>